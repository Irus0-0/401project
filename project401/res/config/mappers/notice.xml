<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="notice">
	
	<!-- 이 영역에 sql 문에 맞는 태그 사용하여 sql 작성
		 select, insert, update, delete 
		 id : 해당 태그 호출할 때 namespae 와 연결 하여 사용
		 parameterType : sql문에 사용될 데이터가 들어있는 객체타입 지정(보통 vo클래스)
		 resultType : select문을 실행한 결과를 담을 객체타입 지정
		 resultMap : 결과 레코드 컬럼명과 vo객체의 property명이 다른 경우 적절한 매핑--><!-- 
		 -->
		 
		 
	<insert id="insertNotice" parameterType="kr.or.ddit.teampro.notice.vo.NoticeVO">
		
		insert into notice(notice_num,master_id,title,content,create_date,notice_grade)
		values (#{noticeNum}, #{masterId},#{notTitle},#{notContent},#{notDate},#{notGrade})
	</insert>
	
	<update id="updateNotice" parameterType="kr.or.ddit.teampro.notice.vo.NoticeVO">
		
		update notice set notice_num = #{noticeNum},title = #{notTitle},content = #{notContent},
		create_date = #{notDate}, grade = #{notGrade} where master_id = #{masterId}
	
	</update>
	
	<delete id="deleteNotice" parameterType="kr.or.ddit.teampro.notice.vo.NoticeVO">
	
		delete from notice whrer master_id = #{masterId}

	</delete>
	
	<!--공지 모두 출력-->
	
	<select id="selectAllNotice" parameterType="kr.or.ddit.teampro.notice.vo.NoticeVO">
		
		select notice_num, master_id,title,content,create_date,notice_grade from notice
	
	</select>
	
	<!--수정할 떄 공지 있나 없나 관리자 id로 체크하기 위해 만들었따. -->
	
	<select id="checkNotice" resultType="int">
	
			select count(*) as cnt from notice where master_id = #{masterId}
	
	</select>
	
	<!--관리자 아이디로 검색했을 때 있으면 공지 가져오기-->
	
	<select id="getNotice" resultType="kr.or.ddit.teampro.notice.vo.NoticeVO">
		
		select notice_num as noticeNum, title as notTitle, content as notContent, create_date as notDate,
		grade as notGrade where master_id = #{masterId}
		
	</select>
	
	<!--resultmap 으로 속성을 매핑시켜라-->
	
	<resultMap id = "notMap" type="notVo">
		
		<result column="notice_num" property = "noticeNum"/>
		<result column="master_id" property = "masterId"/>
		<result column="title" property = "notTitle"/>
		<result column="content" property = "notContent"/>
		<result column="create_date" property = "notDate"/>
		<result column="grade" property = "notGrade"/>
		
	</resultMap>
	
	<!--관리자 아이디로 공지를 검색해서 가져오는 구문 -->
	 
	 <select id="searchNotice" resultMap ="notMap">
		 
		 select * from notice where 1=1
		 
		 <if test="noticeNum != null and noticeNum != ''">
			 and notice_num = #{noticeNum} </if>
		 <if test="notTitle != null and notTitle != ''">
			 and notice_title like '%' || #{notTitle}||'%'  </if>
		 <if test="notContent != null and notContent != ''">
			 and content like '%' || #{notContent}||'%' </if>
		 <if test="notDate != null and notDate != ''">
			 and create_date = #{notDate} </if>
		 <if test="notGrade != null and notGrade != ''">
			 and grade = #{notGrade} </if>
		 
	 </select>
	
	
	
</mapper>